(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{118:function(e,t){},121:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(15),s=n.n(c),o=(n(68),n(33)),i=n.n(o),u=n(52),d=n(2),l=n(3),m=n(5),p=n(4),f=n(6),g=n(34),b=n.n(g),v=function(e){var t=new URL(window.location.href);return!!t.searchParams.has(e)&&t.searchParams.get(e)},_=n(12),h=n(62),E=n(58),k=n(13),S=(n(73),n(8)),y=(n(74),function(e){function t(){var e;return Object(d.a)(this,t),(e=Object(m.a)(this,Object(p.a)(t).call(this))).state={isRecording:!1,recorder:null,videoSrc:null,videoEle:null,startTime:"time"},e.video=r.a.createRef(),e}return Object(f.a)(t,e),Object(l.a)(t,[{key:"getCurrentTime",value:function(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+"-"+e.getTime()}},{key:"render",value:function(){return r.a.createElement("div",{className:"vid_card",onClick:this.startRecording},r.a.createElement("video",{className:"cam",controls:!0,autoPlay:!0,playsInline:!0,muted:!0,ref:this.props.videoRef}),r.a.createElement("p",{className:"cam_label"},this.props.name))}}]),t}(r.a.Component)),C=n(35),x=n.n(C),O=(n(75),{e202102a3710910e7bec39e5617309c7cd746457bad4cefb974db56703f624be:"5704662d325421d22cd6ac36a34b0f3bbc122b72826381a3e6963f3ca66021ab","53e6d1ce5c5155dc835b0670f16924f80b83ef8ab924d56594e743fe8fef9707":"7ea3a51c084b6ef70972173aec1d541feaa191c1e17410de719d16450137b5b0",d2f9c06f0fd3c971c33d50d07ada0cf61bd63812c004d948adaaa15c964c94c9:"b951f9dcfaa8f2887b629736f230142a9d18b8afc88ae6bd6f3c0946e4fad20f",b2a6f55d31cda49fe87a1a87dca3eb2939d20b77505d73c5942b3880b18a48bf:"dc5ca9d0ff799f2bcc2a2fd131eea5a5307e9616d01de2946d09e73bb887f2a2","8199fe2c373a8d4456b04e311ed7f98670411c182974def4fd81249e47665de4":"e466a62b086d05daadf2afe460d0a207f60cac8613fe82cff45cc6c330a91084",bcb109e5b537b4b8519fc10797c86d313a22480d194f6b44477aaa45a27c7876:"1db7be4b7c5815530412e44f8fd7f5f81cddb1ce6f26b8ac2b3e514716247ba6",f80598a32e03e00858cc7591ff533d205d6e768177d1ab04a3c449b2bd954a08:"8d742fd8e09d8bca7e53945c6abf2b5149c1cba92e0f743b5975e054ac5ab061",bebf6b071073727465bb5001223af255af8fa788fbf897aa781a9a7d66ee3222:"8f8a3a01032c360c96b0f6a8f5770bb43aa07d430d495f35ea46a3af47e079e0",a37d9289204bc3893f687e01228f2be6021809752a116d8c3ab0a6f76dc2f844:"785cb91e7331d5d0dddaa04300c767415e0eef26b39ba735aaaccec1e18f9280",bef0b109c5c3c0bc4bc2d2ed22cfe768c9a11b7b7e29d540ede820c0a6472355:"81c60d7dcdae0c9b5aec2e716f2d8fc37751ba2d7c7decb44070524c65b7f583",fe81f26ea9b062d5fe9573c26a13469b6e7c05b6d7293b144e2d11e1020c0444:"abdb69a376084814b2927346a721848146b473d16c469f4b164f7777a772fcd2"});function j(e){var t=Object(a.useState)([]),n=Object(S.a)(t,2),c=n[0],s=n[1],o=Object(a.useState)("recording-status-loading..."),i=Object(S.a)(o,2),u=i[0],d=i[1],l=function(){navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then(function(e){var t=[];e.map(function(e){return"videoinput"===e.kind&&function(e,t){var n={camera_info:{id:e.deviceId,label:e.label,groupId:e.groupId},ref:r.a.createRef(),recorder:null};e.deviceId in O?n.mic_info={id:O[e.deviceId]}:console.error("device not match!!!"),t.push(n)}(e,t),null}),s(t),document.getElementById("startBtn").click(),document.getElementById("startBtn").disabled=!0}).catch(function(e){console.log(e.name+": "+e.message)}):console.log("enumerateDevices() not supported.")};var m=function(){f(!0)},p=function(){var e="recording-status-loading..."===u?{}:u;c.map(function(t){return navigator.mediaDevices.getUserMedia({audio:{deviceId:{exact:t.mic_info?t.mic_info.id:"default"}},video:{frameRate:{exact:30,ideal:30},width:{ideal:1920},height:{ideal:1080},deviceId:t.camera_info.id}}).then(function(n){var a=x()(n,{recorderType:C.MediaStreamRecorder,type:"video",frameRate:30,desiredSampRate:16e3,width:1920,height:1080,numberOfAudioChannels:2,disableLogs:!0});"recording"!==a.getState()&&(a.camera=n,t.recorder=a,t.ref.current.srcObject=n,a.startRecording());g(e,a,t)}).catch(function(e){console.error(e)}),c})},f=function(t){var n="recording-status-loading..."===u?{}:u;c.map(function(a){var r=a.recorder;return null!==r&&(r.stopRecording(function(){var n=r.getBlob();console.log("%c recorded data","background: #222; color: #bada55",n),console.log("beep beep boop boop",t),!0!==t?e.socket.emit("client: save data",{name:v("name"),sentence_index:v("sentence_index"),camera_id:a.camera_info.id,blob:n}):console.log("dummy received, did not save blob")}),g(n,r,a)),c})},g=function(t,n,a){t[a.camera_info.id.substring(0,15)]=n.getState(),d(t),e.updateConnectionStatus(t)},b=function(){var e="recording-status-loading..."===u?{}:u;c.map(function(t){var n=t.recorder,a=n.getState();return"paused"===a?n.resumeRecording():"stopped"===a&&n.startRecording(),g(e,n,t),c})};Object(a.useEffect)(function(){e.updateConnectionStatus(),l()},[]),e.socket.on("server: dummy vid, do not save",function(){document.getElementById("dummyBtn").click(),document.getElementById("dummyBtn").disabled=!0}),e.socket.on("server: start cams",function(){document.getElementById("resumeBtn").click(),document.getElementById("resumeBtn").disabled=!0,document.getElementById("stopBtn").disabled=!1}),e.socket.on("server: stop cams",function(){document.getElementById("stopBtn").click(),document.getElementById("stopBtn").disabled=!0,document.getElementById("resumeBtn").disabled=!1});return function(){var e=c.map(function(e){return r.a.createElement(y,{key:e.camera_info.id,name:"ID: "+e.camera_info.id.substring(0,15),videoRef:e.ref})});return r.a.createElement("div",{id:"camera_list"},function(e){if(e)return r.a.createElement("div",null,r.a.createElement("button",{id:"dummyBtn",onClick:m},"dummy reset"),r.a.createElement("button",{id:"startBtn",onClick:p},"start and pause all cams"),r.a.createElement("button",{id:"resumeBtn",onClick:b},"resume all cams"),r.a.createElement("button",{id:"stopBtn",onClick:f},"stop all cams"))}(!0),r.a.createElement("div",null,r.a.createElement("div",{className:"cameras"},e)))}()}n(76),n(77);var w=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).saveName=function(e){var t=document.getElementById("name").value,a="?name="+t+"&sentence_index=0";window.history.pushState(null,null,a),n.props.socket.emit("client: start testing",{name:t,sentence_index:0}),n.props.socket.emit("client: dummy vid, do not save"),n.props.socket.emit("client: update recording progress",{}),n.props.updateTesterContents(),n.props.updateGreenLightStatus(!0)},n.detectEnter=function(e){13===e.which&&n.saveName(e)},n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"name_input"},r.a.createElement("input",{type:"text",name:"name",id:"name",placeholder:"Enter Name",onKeyPress:this.detectEnter}),r.a.createElement("br",null),r.a.createElement("button",{className:"btn btn-center",onClick:this.saveName},"Save Name")))}}]),t}(a.Component);function N(e){var t=Object(a.useState)(!1),n=Object(S.a)(t,2),c=n[0],s=n[1],o=Object(a.useState)(!1),i=Object(S.a)(o,2),u=i[0],d=i[1],l=Object(a.useState)(!1),m=Object(S.a)(l,2),p=m[0],f=m[1],g=Object(a.useState)(v("name")),b=Object(S.a)(g,2),h=b[0],E=b[1];function k(t){console.log("update sentence from in process screen"),f(!0),e.updateSentence(t)}function y(){return c?"Done":u&&!p?"Retry":"Record"}function C(){d(!0),s(!1),e.socket.emit("client: stop cams","in process screen"),f(!1),_.a.loading("Files are currently saving. Please wait...",{hideAfter:2}),e.updateGreenLightStatus(!1),e.stopTimer(),function(t){var n={};n[t]=!0,e.updateRecordProgress(n)}(e.curr_sentence_index)}function x(){document.getElementById("showSavedFilesBtn").disabled=!1,c?C():(e.socket.emit("client: start cams","in process screen"),s(!0),e.startTimer())}function O(){!function(){var t=!!e.recordedProgress[e.curr_sentence_index]&&e.recordedProgress[e.curr_sentence_index];try{document.getElementById("testerNextBtn").disabled=!t}catch(n){}}();var t=!!e.recordedProgress[e.curr_sentence_index]&&e.recordedProgress[e.curr_sentence_index],n=t?"(\u5f55\u8fc7)":"",a=e.curr_sentence+" "+n;return r.a.createElement("div",{className:t?"recorded_sentence_highlight":""},a)}function j(){E(!0)}return r.a.createElement("div",{className:"test_container"},function(){return h?r.a.createElement("div",null,r.a.createElement("div",{className:"recording_hint"},"Done"===y()?"\u5f55\u5236\u4e2d...":""),r.a.createElement("div",{className:"sentence_to_be_read"},O()),r.a.createElement("button",{id:"testerRecordBtn",className:"Done"===y()?"btn btn-danger":"btn",onClick:x,disabled:!e.recordGreenLight||e.numFilesSaved%e.numCams!==0},"Done"===(t=y())?"\u7ed3\u675f\u5f55\u5236":"Retry"===t?"\u91cd\u65b0\u5f55\u5236":"Record"===t?"\u5f00\u59cb\u5f55\u5236":t),r.a.createElement("br",null),r.a.createElement("button",{className:"btn",id:"testerPrevBtn",onClick:function(){return k("$prev")},disabled:0===e.curr_sentence_index||!e.recordGreenLight||e.numFilesSaved%e.numCams!==0||c},"\u2b05\u4e0a\u4e00\u53e5"),r.a.createElement("button",{className:"btn",id:"testerNextBtn",onClick:function(){return k("$next")},disabled:e.curr_sentence_index===e.data_length-1||!e.recordGreenLight||e.numFilesSaved%e.numCams!==0||c},"\u4e0b\u4e00\u53e5\u27a1")):r.a.createElement("div",null,r.a.createElement(w,{socket:e.socket,updateTesterContents:j,updateGreenLightStatus:e.updateGreenLightStatus}),r.a.createElement("p",{className:"warning_message"},"Enter Name Before Starting"));var t}())}function I(e){var t=Object(a.useState)(void 0),n=Object(S.a)(t,2),c=n[0],s=n[1],o=[];function i(t){t.preventDefault(),e.socket.emit("client: save total time",o),t.returnValue=""}return Object(a.useEffect)(function(){window.addEventListener("beforeunload",i),c||s(function(){var t=[0,0,0];return setInterval(function(){var n=t[0],a=t[1],r=t[2];r<60&&(r+=1),60===r&&(a+=1,r=0),60===a&&(n+=1,a=0),o=t=[n,a,r];try{document.getElementById(e.name).innerHTML="Total Recording Time\u2014"+("0"+n).slice(-2)+":"+("0"+a).slice(-2)+":"+("0"+r).slice(-2)}catch(c){console.error(c)}},1e3)}())},[]),r.a.createElement("div",null,r.a.createElement("pre",{id:e.name}))}var B=function(e){var t=Object(a.useState)(void 0),n=Object(S.a)(t,2),c=n[0],s=n[1];function o(){clearInterval(c),document.getElementById("record_time_content").innerHTML=""}function i(){s(function(){var e=[0,0,0];return setInterval(function(){var t=e[0],n=e[1],a=e[2];a<60&&(a+=1),60===a&&(n+=1,a=0),60===n&&(t+=1,n=0),e=[t,n,a],document.getElementById("record_time_content").innerHTML="Total Recording Time\u2014"+("0"+t).slice(-2)+":"+("0"+n).slice(-2)+":"+("0"+a).slice(-2)},1e3)}())}return r.a.createElement("div",{className:"testing_screen"},function(){if(v("name"))return r.a.createElement(I,{name:"total_timer",socket:e.socket})}(),e.comp_progressBar(e.curr_sentence_index,e.data_length,"center",2),r.a.createElement("div",{className:"middle"},r.a.createElement("div",{className:"inner"},r.a.createElement(N,{updateSentence:e.updateSentence,curr_sentence_index:e.curr_sentence_index,data_length:e.data_length,socket:e.socket,data:e.data,curr_sentence:e.curr_sentence,recordGreenLight:e.recordGreenLight,updateGreenLightStatus:e.updateGreenLightStatus,numFilesSaved:e.numFilesSaved,numCams:e.numCams,stopTimer:o,startTimer:i,recordedProgress:e.recordedProgress,updateRecordProgress:e.updateRecordProgress})),r.a.createElement("div",null,r.a.createElement("pre",{id:"record_time_content"}))),r.a.createElement("pre",{hidden:e.recordGreenLight||0===e.curr_sentence_index||!v("name"),className:"warning_message"},"There may be an issue with file saves. Please notify research facilitator."))},P=function(e){function t(){return Object(d.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"table_header_footer"},r.a.createElement("div",null,"Sentence")))}}]),t}(a.Component),F=(n(78),n(79),function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).getClassOfRowItem=function(){return(n.props.read?"read row_item":"row_item")+(n.props.curr_sentence_index===n.props.index?" curr_sentence":"")},n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"table_row"},r.a.createElement("div",{className:this.getClassOfRowItem()},this.props.index+": "+this.props.sentence)))}}]),t}(a.Component)),L=(n(80),function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).updateDataOnPageChange=function(){},n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.data,n=this.props.curr_page,a=this.props.max_per_page,c=n*a-a,s=c+a,o=t.slice(c,s).map(function(t,n){return r.a.createElement(F,{curr_sentence_index:e.props.curr_sentence_index,sentence:t,time:"00:00",read:!1,key:t+":"+n,index:n+c})});return r.a.createElement("div",{className:"table"},o)}}]),t}(a.Component)),R=(n(81),function(e){function t(){return Object(d.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:this.props.selected?"page_num":"can_click_num page_num",onClick:function(){return e.props.updatePage(e.props.num)}},this.props.num)}}]),t}(a.Component)),D=n(53),M=n.n(D),T=n(54),G=n.n(T),A=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){n.props.updatePage(Number(e.target.value))},n.handleSubmit=function(e){e.preventDefault()},n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("label",{htmlFor:"page"},"Page:"),r.a.createElement("input",{type:"text",value:this.props.curr_page,onChange:this.handleChange})))}}]),t}(a.Component),H=n(55),V=n.n(H),J=n(56),$=n.n(J),U=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).updatePage=function(e){n.props.updatePage(e)},n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.curr_page,n=this.props.max_per_page,a=Math.floor(n/2),c=Number(((this.props.total_data+1)/this.props.max_per_page+1).toFixed(0)),s=Array.from(new Array(n),function(e,r){return t<=a?r:t>=c-a?r+c-n:r+t-a-1}).map(function(n){return n+=1,r.a.createElement(R,{num:n,selected:t===n,key:n,updatePage:e.props.updatePage})});return r.a.createElement("div",null,r.a.createElement("div",{className:"table_header_footer"},r.a.createElement("div",{className:"table_footer"},r.a.createElement("div",{className:"left_footer"},r.a.createElement(A,{updatePage:this.props.updatePage,curr_page:this.props.curr_page})),r.a.createElement("div",{className:"right_footer"},r.a.createElement("img",{src:V.a,alt:"",className:"small_btn",onClick:function(){return e.props.updatePage(1)}}),r.a.createElement("img",{src:G.a,alt:"",className:"small_btn",onClick:function(){return e.props.updatePage(t-1)}}),s,r.a.createElement("img",{src:M.a,alt:"",className:"small_btn",onClick:function(){return e.props.updatePage(t+1)}}),r.a.createElement("img",{src:$.a,alt:"",className:"small_btn",onClick:function(){return e.props.updatePage(c)}})))))}}]),t}(a.Component),W=function(e){function t(e){var n;Object(d.a)(this,t);return(n=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={max_per_page:8},n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(P,null),r.a.createElement(L,{data:this.props.data,curr_page:this.props.curr_page,max_per_page:this.state.max_per_page,curr_sentence_index:this.props.curr_sentence_index}),r.a.createElement(U,{total_data:this.props.data.length,updatePage:this.props.updatePage,curr_page:this.props.curr_page,max_per_page:this.state.max_per_page}))}}]),t}(a.Component),K=function(e){function t(){return Object(d.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"name_field"}),r.a.createElement("div",{className:"data_table"},r.a.createElement(W,{data:this.props.data,curr_sentence_index:this.props.curr_sentence_index,curr_page:this.props.curr_page,updatePage:this.props.updatePage})))}}]),t}(a.Component),Y=n(17),q=n.n(Y);function z(e){var t=Object(Y.useModali)({animated:!0,title:e.title,message:e.message,buttons:[r.a.createElement(q.a.Button,{label:e.buttonCancel?e.buttonCancel:"",isStyleCancel:!0,className:e.buttonCancel?"":"display_none",key:e.buttonCancel,hidden:!e.buttonCancel,onClick:function(){return s()}}),r.a.createElement(q.a.Button,{label:e.buttonConfirm,isStyleDestructive:!0,onClick:function(){e.confirmFunc&&e.confirmFunc(),s(),e.toast&&_.a.info(e.toast)},hidden:!e.buttonConfirm,key:e.buttonConfirm})]}),n=Object(S.a)(t,2),c=n[0],s=n[1];return Object(a.useEffect)(function(){e.onLoadFunc&&e.onLoadFunc();try{e.buttonCancel||(document.getElementsByClassName("modali-button-cancel")[0].className+=" display_none"),e.buttonConfirm||(document.getElementsByClassName("modali-button-destructive")[0].className+=" display_none")}catch(t){}},[]),r.a.createElement("div",{style:{height:"0px"}},r.a.createElement("button",{className:"hidden_button",id:e.modalID,onClick:s},"toggle modal"),r.a.createElement(q.a.Modal,c))}var Q=n(57),X=n.n(Q),Z=function(e){function t(e){var n;Object(d.a)(this,t),(n=Object(m.a)(this,Object(p.a)(t).call(this,e))).socket_getSetCompID=function(e){var t={};n.setState({computerID:e}),t[n.state.computerID]=[],n.setState({computerStatus:t},function(){console.log("init computer status",n.state.computerStatus)})},n.boldString=function(e,t){var n=new RegExp(t,"g");return e.replace(n,"\ud83d\udda5: "+t)},n.socket_updateConnectionStatus=function(e){console.log("updating connection status here!!! "+JSON.stringify(e)),n.setState({computerStatus:e})},n.showFileSavedMessage=function(){_.a.success("Files successfully saved.",{hideAfter:1.5})},n.initSocketListeners=function(){n.props.socket.on("server: connected sync id",function(e){n.socket_getSetCompID&&n.socket_getSetCompID(e),n.socket_getSetCompID=null}),n.props.socket.on("server: reset cams",function(){n.updateGreenLightStatus(!0)}),n.props.socket.on("server: response for connection status",function(e){try{document.getElementById("connection_status").innerHTML=n.boldString(JSON.stringify(e,null,2),n.state.computerID)}catch(t){}}),n.props.socket.on("server: response for recording status",function(e){console.log("beeppppps"+JSON.stringify(e))}),n.props.socket.on("server: response for progress",function(e){n.setState({recordedProgress:e});try{n.setState({curr_sentence_index:Object.keys(e).length})}catch(t){console.error(t)}}),n.props.socket.on("server: response for numFilesSaved",function(e){n.helper_updateFilesSaved(e)}),n.props.socket.on("server: save files successful",function(e){n.helper_updateFilesSaved(e),n.setState({numFilesSavedInd:n.state.numFilesSavedInd+1},function(){if(console.log("this occured: "+n.state.numFilesSavedInd+" times."),n.state.numFilesSavedInd===n.state.numCams){console.log("correct number of files saved");try{document.getElementById("showSavedFilesBtn").click(),document.getElementById("showSavedFilesBtn").disabled=!0,n.setState({numFilesSavedInd:0},function(){try{document.getElementById("testerNextBtn").click()}catch(e){console.error(e)}}),n.updateGreenLightStatus(!0)}catch(e){console.error(e)}try{n.helper_checkIfMobileView()&&(console.log("here here??"),_.a.info("Completed @ Sentence ["+n.state.curr_sentence_index+"]",{hideAfter:.75})),console.log("clicked??")}catch(t){console.error(t)}}})}),n.props.socket.on("server: computer connected order",function(e){n.setState({connectedOrderMap:b()(n.state.connectedOrderMap,{$merge:e})})});var e=[0,666,1332];n.props.socket.on("server: refresh all",function(){var t=n.state.connectedOrderMap[n.state.computerID];setTimeout(function(){window.location.reload(!1)},e[t%3])})},n.helper_updateFilesSaved=function(e){var t=e%n.state.numCams===0?" (successful)":" (not all cams saved!!)";n.setState({numFilesSavedTotal:e});try{document.getElementById("num_files_saved").innerHTML="Total Files Saved: "+e+t}catch(a){}},n.updateSentence=function(e){console.log("update sentence called here beep"),"$next"===e?n.state.curr_sentence_index+1===n.state.data.length?alert("\u5b9e\u9a8c\u7ed3\u675f\uff01\u8c22\u8c22\u60a8\u7684\u53c2\u4e0e"):n.setState({curr_sentence_index:n.state.curr_sentence_index+1},function(){n.updateSentence(n.state.data[n.state.curr_sentence_index]),n.props.socket.emit("client: update sentence_index",{name:v("name"),curr_sentence_index:n.state.curr_sentence_index})}):"$prev"===e?n.setState({curr_sentence_index:Math.max(n.state.curr_sentence_index-1,0)},function(){n.updateSentence(n.state.data[n.state.curr_sentence_index]),n.props.socket.emit("client: update sentence_index",{name:v("name"),curr_sentence_index:n.state.curr_sentence_index})}):(window.history.pushState(null,null,"?name="+v("name")+"&sentence_index="+n.state.curr_sentence_index),n.setState({curr_sentence:e,curr_page:Math.floor(Number(n.state.curr_sentence_index)/n.state.per_page)+1}))},n.updatePage=function(e){console.log("update page",e),n.setState({curr_page:e>=1?e:1})},n.updateRecordProgress=function(e){console.log("added to progress ",JSON.stringify(e)),n.setState({recordedProgress:b()(n.state.recordedProgress,{$merge:e})},function(){n.props.socket.emit("client: update recording progress",n.state.recordedProgress)})},n.updateConnectionStatus=function(e){if(n.state.computerStatus[n.state.computerID]){var t={};t[n.state.computerID]=e,n.setState({computerStatus:t},function(){console.log(n.state.computerStatus)}),n.props.socket.emit("client: update recording status",t)}console.log(e),n.getStatus()},n.comp_dataCollection=function(){return r.a.createElement(K,{data:n.state.data,updateName:n.updateName,curr_sentence:n.state.curr_sentence,socket:n.props.socket,curr_sentence_index:n.state.curr_sentence_index,curr_page:n.state.curr_page,updatePage:n.updatePage})},n.updateGreenLightStatus=function(e){n.setState({recordGreenLight:e})},n.comp_tester=function(){return r.a.createElement(B,{updateSentence:n.updateSentence,data:n.state.data,curr_sentence_index:n.state.curr_sentence_index,data_length:n.state.data.length,first_sentence:n.state.data[n.state.curr_sentence_index],curr_sentence:n.state.curr_sentence,socket:n.props.socket,recordGreenLight:n.state.recordGreenLight&&n.state.numFilesSavedTotal%n.state.numCams===0,numFilesSaved:n.state.numFilesSavedTotal,numCams:n.state.numCams,updateGreenLightStatus:n.updateGreenLightStatus,recordedProgress:n.state.recordedProgress,updateRecordProgress:n.updateRecordProgress,comp_progressBar:n.comp_progressBar})},n.comp_userResearchHeader=function(){return r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("h1",null,"For User Researcher Purpose Only"),r.a.createElement("hr",null))},n.getStatus=function(){n.props.socket.emit("client: ping for connection status"),n.props.socket.emit("client: ping for numFilesSaved"),n.props.socket.emit("client: ping for progress")},n.resetCams=function(){n.props.socket.emit("client: dummy vid, do not save"),n.updateGreenLightStatus(!0),n.props.socket.emit("client: reset cams"),_.a.info("Cams are reset")},n.refreshAll=function(){n.props.socket.emit("client: refresh all")},n.comp_cameraList=function(){return r.a.createElement(j,{socket:n.props.socket,computerID:n.state.computerID,computerStatus:n.state.computerStatus,updateConnectionStatus:n.updateConnectionStatus})},n.toggleModal=function(e){document.getElementById(e).click()},n.helper_checkIfMobileView=function(){return window.location.href.includes("mobile")},n.comp_overallStatusContent=function(){return r.a.createElement("div",null,r.a.createElement("h4",null,"Connection Status"),r.a.createElement("pre",{id:"connection_status"}),r.a.createElement("pre",{id:"num_files_saved"}),r.a.createElement("pre",{hidden:n.state.recordGreenLight||n.helper_checkIfMobileView()||!v("name"),className:"warning_message"},"Please Click Reset!"),n.comp_progressBar(n.state.curr_sentence_index,n.state.data.length-1,"left",3))},n.comp_modals=function(){return r.a.createElement("div",null,r.a.createElement(z,{modalID:"resetProgressModal",socket:n.props.socket,title:"Are you sure?",message:"Resetting progress will be permanent.",buttonCancel:"Cancel",buttonConfirm:"Reset",toast:"Progress reset",confirmFunc:function(){n.props.socket.emit("client: update recording progress",{})}}),r.a.createElement(z,{modalID:"overallStatus",socket:n.props.socket,title:"Status",onLoadFunc:n.getStatus,message:n.comp_overallStatusContent(),buttonConfirm:"Hide"}))},n.comp_debug=function(){return r.a.createElement("div",{style:{margin:"auto",textAlign:"center"}},r.a.createElement("button",{onClick:function(){n.toggleModal("overallStatus"),n.getStatus()},className:"debug_button"},"Status"),r.a.createElement("button",{id:"resetCamsBtn",className:"debug_button",onClick:n.resetCams},"Reset Cams"),r.a.createElement("button",{className:"debug_button",onClick:function(){n.toggleModal("resetProgressModal")}},"Reset Progress"),r.a.createElement("button",{className:"debug_button",onClick:n.refreshAll},"Refresh All"),r.a.createElement("button",{onClick:n.showFileSavedMessage,id:"showSavedFilesBtn",className:"hidden_button"}),r.a.createElement("pre",{hidden:8===n.state.numCams},"debug mode, remember to change num cams back to 8"))},n.desktopView=function(){return r.a.createElement("div",{className:"container"},n.comp_debug(),n.comp_tester(),n.comp_userResearchHeader(),r.a.createElement("div",{className:"contents"},r.a.createElement("div",{className:"left_panel"},n.comp_dataCollection()),r.a.createElement("div",{className:"right_panel cameras_container"},n.comp_cameraList()),r.a.createElement("div",{className:""})))},n.mobileView=function(){return r.a.createElement("div",{onClick:function(){return n.getStatus()}},n.comp_modals(),n.comp_debug())};var a=v("sentence_index");return n.state={curr_sentence:"",curr_sentence_index:a?Number(a):0,data:[],per_page:8,curr_page:a?Math.floor(Number(a)/8)+1:1,computerStatus:{},recordGreenLight:!1,computerID:-1,numFilesSavedTotal:0,numFilesSavedInd:0,connectedOrderMap:{},numCams:1,recordedProgress:{}},n.helper_checkIfMobileView?n.props.socket.emit("client: ask for recording status"):n.props.socket.emit("client: update sentence_index",{name:v("name"),curr_sentence_index:n.state.curr_sentence_index}),e.socket.emit("client: check for progress"),e.socket.emit("client: ask for sync id"),n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"readTextFile",value:function(e){var t=this;return fetch(e).then(function(e){return e.text()}).then(function(e){t.setState({data:e.split("\n")},function(){var e=v("sentence_index")?t.state.data[Number(v("sentence_index"))]:t.state.data[0];t.setState({curr_sentence:e},function(){})})})}},{key:"pingServer",value:function(){var e=Object(u.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.props.socket.io.opts.hostname,e.next=4,fetch(t,{mode:"no-cors"});case 4:e.sent.ok?console.log("connection successful"):console.error("no response from server"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.readTextFile(X.a),this.initSocketListeners(),this.pingServer(),window.addEventListener("keydown",this.downHandler)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.downHandler),window.removeEventListener("beforeunload")}},{key:"comp_progressBar",value:function(e,t,n,a){var c=(e/t*100).toFixed(2),s="left"===n?{margin:"0"}:{};return r.a.createElement("div",{className:"progress_bar",style:s},r.a.createElement("pre",null,"Progress: ",e," / ",t," (",c,"%)"),r.a.createElement(h.a,{percent:c,strokeWidth:a,trailWidth:a,strokeColor:"#2db7f5",trailColor:"#D9D9D9"}))}},{key:"downHandler",value:function(e){var t=e.key;[" ","ArrowLeft","ArrowRight","Escape"].includes(t)&&(" "===t?document.getElementById("testerRecordBtn").click():"ArrowLeft"===t?document.getElementById("testerPrevBtn").click():"ArrowRight"===t?(console.log("detected right arrow key"),document.getElementById("testerNextBtn").click()):"Escape"===t&&document.getElementById("resetCamsBtn").click(),e.preventDefault())}},{key:"render",value:function(){return r.a.createElement(E.a,null,r.a.createElement(k.a,{path:"/",exact:!0,component:this.desktopView}),r.a.createElement(k.a,{path:"/mobile",exact:!0,component:this.mobileView}),this.comp_modals())}}]),t}(r.a.Component),ee=n(61),te=n.n(ee)()("http://192.168.0.101:5000");s.a.render(r.a.createElement(Z,{socket:te}),document.getElementById("root"))},53:function(e,t,n){e.exports=n.p+"static/media/collapse-chevron.126ea5d6.svg"},54:function(e,t,n){e.exports=n.p+"static/media/expand-chevron.fd7409a7.svg"},55:function(e,t,n){e.exports=n.p+"static/media/beg.565428a5.svg"},56:function(e,t,n){e.exports=n.p+"static/media/end.b927e101.svg"},57:function(e,t,n){e.exports=n.p+"static/media/sentences-english-test.d9eb1bf6.txt"},63:function(e,t,n){e.exports=n(121)},68:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){},81:function(e,t,n){}},[[63,1,2]]]);
//# sourceMappingURL=main.666e0fdb.chunk.js.map