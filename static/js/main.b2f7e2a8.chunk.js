(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{109:function(e,t){},112:function(e,t,n){},113:function(e,t,n){},114:function(e,t,n){},115:function(e,t,n){},116:function(e,t,n){},117:function(e,t,n){},118:function(e,t,n){},119:function(e,t,n){},131:function(e,t,n){},132:function(e,t,n){},133:function(e,t,n){},134:function(e,t,n){},138:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(17),o=n.n(c),s=(n(73),n(33)),i=n.n(s),l=n(53),d=n(2),u=n(3),m=n(5),p=n(4),g=n(6),h=n(54),f=n(55),v=n.n(f),b=function(e){var t=new URL(window.location.href);return!!t.searchParams.has(e)&&t.searchParams.get(e)},_=n(7),E=n(65),y=n(14),k=n(34),C=n.n(k),S=n(18),N=(n(112),n(9)),I=(n(113),function(e){function t(){var e;return Object(d.a)(this,t),(e=Object(m.a)(this,Object(p.a)(t).call(this))).state={isRecording:!1,recorder:null,videoSrc:null,videoEle:null,startTime:"time"},e.video=r.a.createRef(),e}return Object(g.a)(t,e),Object(u.a)(t,[{key:"getCurrentTime",value:function(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+"-"+e.getTime()}},{key:"render",value:function(){return r.a.createElement("div",{className:"vid_card",onClick:this.startRecording},r.a.createElement("video",{className:"cam",controls:!0,autoPlay:!0,playsInline:!0,muted:!0,ref:this.props.videoRef}),r.a.createElement("p",{className:"cam_label"},this.props.name))}}]),t}(r.a.Component)),w=n(35),B=n.n(w);function O(e){var t=Object(a.useState)([]),n=Object(N.a)(t,2),c=n[0],o=n[1],s=Object(a.useState)("recording-status-loading..."),i=Object(N.a)(s,2),l=i[0],d=i[1],u=Object(a.useState)([]),m=Object(N.a)(u,2),p=m[0],g=m[1],h=Object(a.useState)([]),f=Object(N.a)(h,2),v=f[0],E=f[1],y=function(e){return{camera_info:{id:e.deviceId,label:e.label,groupId:e.groupId},ref:r.a.createRef(),recorder:null}},k=function(){navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then(function(t){var n=[],a=[];!function(t){var n=t.reduce(function(e,t){return"videoinput"===t.kind?e+1:e},0);e.updateDetectedNumCams(n)}(t),t.map(function(e){return"audioinput"===e.kind&&(e.label.toLowerCase().includes("default")||e.label.toLowerCase().includes("communications")||e.label.toLowerCase().includes("built-in")||function(e,t){t.indexOf(e.deviceId)<0&&t.push(e)}(e,a)),"videoinput"===e.kind&&function(e,t){e=y(e);var n=c.filter(function(t){return t.camera_info.id===e.camera_info.id})[0];e.mic_info=n?n.mic_info:p[0],t.push(e)}(e,n),null}),g(a),o(n),document.getElementById("startBtn").click(),document.getElementById("startBtn").disabled=!0}).catch(function(e){console.log(e.name+": "+e.message)}):console.log("enumerateDevices() not supported.")};Array.prototype.diff=function(e){return this.filter(function(t){return e.indexOf(t)<0})};var C=!1,S=function(t,n){if(t){var a=y(t);a.mic_info=n.deviceId,o([a]),document.getElementById("startBtn").disabled=!1,document.getElementById("startBtn").click(),document.getElementById("dummyBtn").disabled=!1,document.getElementById("dummyBtn").click(),_.a.success("Mac FaceTime Camera started",{position:"top-left",hideAfter:1,onClick:function(e){e()}}),e.updateDetectedNumCams(1),C=!0}},O=function(){try{!function(e){var t=void 0,n=void 0;new Promise(function(){navigator.mediaDevices.enumerateDevices().then(function(e){t=e.filter(function(e){return e.label.toLowerCase().includes("facetime")}),n=e.filter(function(e){return"default"===e.deviceId})}).then(function(){e(t[0],n[0])})})}(S)}catch(e){}navigator.mediaDevices.enumerateDevices().then(function(e){var t=e.filter(function(e){return e.label.toLowerCase().includes("aoni")&&!e.label.toLowerCase().includes("communication")&&!e.label.toLowerCase().includes("default")}),n=!1,a=t.map(function(e){return e.deviceId}),r=a.diff(v);if(0===r.length?C||_.a.warn("No additional webcams detected.",{hideAfter:1}):2===r.length&&(n=!0),n){var s=function(e,t){var n=t.filter(function(t){return e.indexOf(t.deviceId)>=0&&"videoinput"===t.kind}),a=t.filter(function(t){return e.indexOf(t.deviceId)>=0&&"audioinput"===t.kind});return a.length>1&&console.error("multiple new mics detected"),n.length>1&&console.error("multiple new cams detected"),[a[0].deviceId,n[0]]}(r,t),i=Object(N.a)(s,2),l=i[0],d=i[1];if(d=y(d),!c.filter(function(e){return e.camera_info.id===d.camera_info.id})[0]){d.mic_info=l;var u=c;u.push(d),o(u),_.a.success("Webcam: "+d.camera_info.id.substring(0,5)+" added.",{hideAfter:1,position:"top-left",onClick:function(e){return e()}}),document.getElementById("startBtn").disabled=!1,k(),E(a)}}}).then(function(){document.getElementById("dummyBtn").disabled=!1,document.getElementById("dummyBtn").click()})};var x=function(){j(!0)},P=function(){var e="recording-status-loading..."===l?{}:l;c.map(function(t){return t.mic_info||console.error("using default microphone..."),navigator.mediaDevices.getUserMedia({audio:{deviceId:{exact:t.mic_info?t.mic_info:"default"}},video:{frameRate:{exact:30,ideal:30},width:{ideal:1920},height:{ideal:1080},deviceId:t.camera_info.id}}).then(function(n){var a=B()(n,{recorderType:w.MediaStreamRecorder,type:"video",frameRate:30,desiredSampRate:16e3,width:1920,height:1080,numberOfAudioChannels:2,disableLogs:!0});if("recording"!==a.getState()){a.camera=n,t.recorder=a;var r=t.ref;try{r.current.srcObject=n}catch(c){}a.startRecording()}L(e,a,t)}).catch(function(e){console.error(e)}),c})},j=function(t){var n="recording-status-loading..."===l?{}:l;c.map(function(a){var r=a.recorder;return null!==r&&(r.stopRecording(function(){var n=r.getBlob();console.log("%c recorded data","background: #222; color: #bada55",n),!0!==t?e.socket.emit("client: save data",{name:b("name"),sentence_index:b("sentence_index"),camera_id:a.camera_info.id,blob:n}):console.log("dummy received, did not save blob")}),L(n,r,a)),c})},L=function(t,n,a){try{t[a.camera_info.id.substring(0,15)]=n.getState(),d(t),e.updateConnectionStatus(t)}catch(r){_.a.warn("Camera not yet loaded!",{hideAfter:0,onClick:function(e){e()}})}},T=function(){var e="recording-status-loading..."===l?{}:l;c.map(function(t){var n=t.recorder,a=void 0;try{a=n.getState()}catch(r){_.a.warn("Camera not yet loaded!",{hideAfter:0,onClick:function(e){e()}})}if("paused"===a)n.resumeRecording();else if("stopped"===a)try{n.startRecording()}catch(o){_.a.warn("Camera not yet loaded!",{hideAfter:0,onClick:function(e){e()}})}return L(e,n,t),c})};Object(a.useEffect)(function(){e.updateConnectionStatus()},[e.addCamState]),e.socket.on("server: dummy vid, do not save",function(){try{document.getElementById("dummyBtn").click(),document.getElementById("dummyBtn").disabled=!0}catch(e){console.error(e)}}),e.socket.on("server: start cams",function(){try{document.getElementById("resumeBtn").click(),document.getElementById("resumeBtn").disabled=!0,document.getElementById("stopBtn").disabled=!1}catch(e){console.error(e)}}),e.socket.on("server: stop cams",function(){try{document.getElementById("stopBtn").click(),document.getElementById("stopBtn").disabled=!0,document.getElementById("resumeBtn").disabled=!1}catch(e){console.error(e)}});return function(e){var t=0,n=c.map(function(e){return r.a.createElement(I,{key:t++,name:"ID: "+e.camera_info.id.substring(0,15),videoRef:e.ref})});return r.a.createElement("div",{id:"camera_list"},function(e){if(e)return r.a.createElement("div",null,r.a.createElement("button",{id:"dummyBtn",className:"hidden_button",onClick:x},"dummy reset"),r.a.createElement("button",{id:"startBtn",className:"hidden_button",onClick:P},"start and pause all cams"),r.a.createElement("button",{id:"resumeBtn",className:"hidden_button",onClick:T},"resume all cams"),r.a.createElement("button",{id:"stopBtn",className:"hidden_button",onClick:j},"stop all cams"),r.a.createElement("button",{id:"addCamBtn",className:"hidden_button",onClick:O},"Add Cam"))}(!0),r.a.createElement("div",null,r.a.createElement("button",{className:"debug_button",style:{marginBottom:"1em"},onClick:e},"Add Webcam"),r.a.createElement("div",{className:"cameras"},n)))}(e.addCam)}n(114),n(115);var x=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).saveName=function(){var e=document.getElementById("name").value,t="?name="+e+"&sentence_index=0";window.history.pushState(null,null,t),n.props.socket.emit("client: start testing",{name:e,sentence_index:0}),n.props.socket.emit("client: dummy vid, do not save"),n.props.socket.emit("client: update recording progress",0),n.props.socket.emit("client: save total time",[0,0,0]),n.props.socket.emit("client: save total start time",new Date),n.props.updateTesterContents(),n.props.updateGreenLightStatus(!0)},n.isNameEmpty=function(){try{return!document.getElementById("name").value.replace(/\s/g,"").length}catch(e){}},n.detectEnter=function(e){n.isNameEmpty()?document.getElementById("nameNotFilled").innerText="\u8bf7\u8f93\u5165\u540d\u5b57":13===e.which&&n.saveName(e)},n.startBtn=function(e){n.isNameEmpty()?document.getElementById("nameNotFilled").innerText="\u8bf7\u8f93\u5165\u540d\u5b57":e.buttons||n.saveName(document.getElementById("name").value)},n}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"name_input"},r.a.createElement("input",{type:"text",name:"name",id:"name",placeholder:"\u8f93\u5165\u540d\u5b57\uff08\u62fc\u97f3\uff09",onKeyPress:this.detectEnter,autoFocus:!0,required:!0}),r.a.createElement("br",null),r.a.createElement("button",{className:"btn btn-center",onClick:this.startBtn},"\u5f00\u59cb\u5b9e\u9a8c"),this.isNameEmpty()&&r.a.createElement("p",{className:"warning_message",id:"nameNotFilled"})))}}]),t}(a.Component);function P(e){var t=Object(a.useState)(!1),n=Object(N.a)(t,2),c=n[0],o=n[1],s=Object(a.useState)(!1),i=Object(N.a)(s,2),l=i[0],d=i[1],u=Object(a.useState)(!1),m=Object(N.a)(u,2),p=m[0],g=m[1],h=Object(a.useState)(b("name")),f=Object(N.a)(h,2),v=f[0],_=f[1];function E(t){g(!0),e.updateSentence(t)}function y(){return c?"Done":l&&!p?"Retry":"Record"}function k(){var t;d(!0),o(!1),e.socket.emit("client: stop cams","in process screen"),g(!1),e.showFileSavingLoader(),e.updateSentence("$next"),e.updateGreenLightStatus(!1),e.stopTimer(),(t=e.curr_sentence_index)>=0&&e.updateRecordProgress(t)}function C(){document.getElementById("showSavedFilesBtn").disabled=!1,c?k():(e.socket.emit("client: start cams","in process screen"),o(!0),e.startTimer(),document.getElementById("testerRecordBtn").className="btn btn-danger")}function S(){!function(){if(!e.debugMode){var t=e.recordedProgress>e.curr_sentence_index;try{document.getElementById("testerNextBtn").disabled=!t}catch(n){}}}();var t=e.curr_sentence_index>0&&e.recordedProgress>=e.curr_sentence_index,n=t?"\u21ba":"",a=e.data[e.curr_sentence_index];a&&(a=function(e,t){return r.a.createElement("div",{className:"emoji-layout-container"},r.a.createElement("div",{className:"emoji-layout-emoji-left"}," ",t),r.a.createElement("div",null,e),r.a.createElement("div",{className:"emoji-layout-emoji-right"}," ",t))}(a,n));var c=t?"recorded_sentence_highlight sentence_to_be_read":"sentence_to_be_read";return r.a.createElement("div",null,r.a.createElement("div",{className:c},a))}function I(){_(!0)}return r.a.createElement("div",{className:"test_container"},function(){if(v){try{var t=document.getElementById("record_time_content"),n=document.getElementById("record_time_msg");"gray"===("00:00:00"===t.innerText?"gray":"red")?(t.style.transition="all 0.5 ease",n.style.transition="all 0.5 ease",t.style.color="black",n.style.color="black"):(t.style.transition="all 0.5 ease",n.style.transition="all 0.5 ease",t.style.color="#FF1053",n.style.color="#FF1053")}catch(o){}return r.a.createElement("div",null,S(),r.a.createElement("div",{className:"recording_hint"},r.a.createElement("pre",{id:"record_time_content"},"00:00:00"),r.a.createElement("pre",{id:"record_time_msg"},"\u5f55\u5236\u4e2d")),r.a.createElement("button",{id:"testerRecordBtn",className:"Done"===y()?"btn btn-danger":"btn btn_highlight_green",onClick:C,disabled:!e.recordGreenLight||e.numFilesSaved%e.requiredNumCams!==0||!e.connectedToServer},"Done"===(a=y())?"\u7ed3\u675f\u5f55\u5236":"Retry"===a?"\u5f00\u59cb\u5f55\u5236":"Record"===a?"\u5f00\u59cb\u5f55\u5236":a),r.a.createElement("br",null),r.a.createElement("button",{className:"btn",id:"testerPrevBtn",onClick:function(){return E("$prev")},disabled:0===e.curr_sentence_index||!e.recordGreenLight||e.numFilesSaved%e.requiredNumCams!==0||c},"\u2b05\u4e0a\u4e00\u53e5"),r.a.createElement("button",{className:"btn",id:"testerNextBtn",onClick:function(){return E("$next")},disabled:e.curr_sentence_index===e.data_length-1||!e.recordGreenLight||e.numFilesSaved%e.requiredNumCams!==0||c},"\u4e0b\u4e00\u53e5\u27a1"),0===e.detectedNumCams&&r.a.createElement("p",{className:"warning_message"},"\u8bf7\u52a0\u6444\u50cf\u5934"),!e.connectedToServer&&r.a.createElement("p",{className:"warning_message"},"\u8bf7\u786e\u8ba4\u60a8\u94fe\u63a5\u5230\u670d\u52a1\u5668"))}return r.a.createElement("div",null,r.a.createElement(x,{socket:e.socket,updateTesterContents:I,updateGreenLightStatus:e.updateGreenLightStatus}));var a}())}var j=function(e){var t=Object(a.useState)(void 0),n=Object(N.a)(t,2),c=n[0],o=n[1];function s(){clearInterval(c),document.getElementById("record_time_content").innerHTML="00:00:00"}function i(){o(function(){var e=[0,0,0];return setInterval(function(){var t=e[0],n=e[1],a=e[2];a<60&&(a+=1),60===a&&(n+=1,a=0),60===n&&(t+=1,n=0),e=[t,n,a],document.getElementById("record_time_content").innerHTML=("0"+t).slice(-2)+":"+("0"+n).slice(-2)+":"+("0"+a).slice(-2)},10)}())}return r.a.createElement("div",{className:"testing_screen"},e.comp_totalProgress(!1,1.5),r.a.createElement("div",null),e.comp_saveProgress(),r.a.createElement("div",{className:"middle"},r.a.createElement("div",{className:"inner"},r.a.createElement(P,{updateSentence:e.updateSentence,curr_sentence_index:e.curr_sentence_index,data_length:e.data_length,socket:e.socket,data:e.data,curr_sentence:e.curr_sentence,recordGreenLight:e.recordGreenLight,updateGreenLightStatus:e.updateGreenLightStatus,numFilesSaved:e.numFilesSaved,requiredNumCams:e.requiredNumCams,stopTimer:s,startTimer:i,recordedProgress:e.recordedProgress,updateRecordProgress:e.updateRecordProgress,showFileSavingLoader:e.showFileSavingLoader,debugMode:e.debugMode,connectedToServer:e.connectedToServer,detectedNumCams:e.detectedNumCams}))),r.a.createElement("pre",{hidden:e.recordGreenLight||0===e.curr_sentence_index||!b("name"),className:"warning_message"},"\u5982\u679c\u7b49\u4fdd\u5b58\u65f6\u95f4\u591a\u4f5910\u79d2\u949f\uff0c\u901a\u77e5\u8001\u5e08\u6765\u4ece\u8bbe\u7f6e\u673a\u5668"))},L=function(e){function t(){return Object(d.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"table_header_footer"},r.a.createElement("h3",null,"Sentence")))}}]),t}(a.Component),T=(n(116),n(117),function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).getClassOfRowItem=function(){return(n.props.read?"read row_item":"row_item")+(n.props.curr_sentence_index===n.props.index?" curr_sentence":"")},n}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"table_row"},r.a.createElement("div",{className:this.getClassOfRowItem()},this.props.index+": "+this.props.sentence)))}}]),t}(a.Component)),D=(n(118),function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).updateDataOnPageChange=function(){},n}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props.data,n=this.props.curr_page,a=this.props.max_per_page,c=n*a-a,o=c+a,s=t.slice(c,o).map(function(t,n){return r.a.createElement(T,{curr_sentence_index:e.props.curr_sentence_index,sentence:t,time:"00:00",read:!1,key:t+":"+n,index:n+c})});return r.a.createElement("div",{className:"table"},s)}}]),t}(a.Component)),M=(n(119),function(e){function t(){return Object(d.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:this.props.selected?"page_num":"can_click_num page_num",onClick:function(){return e.props.updatePage(e.props.num)}},this.props.num)}}]),t}(a.Component)),F=n(56),R=n.n(F),A=n(57),G=n.n(A),W=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){n.props.updatePage(Number(e.target.value))},n.handleSubmit=function(e){e.preventDefault()},n}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("label",{htmlFor:"page"},"Page:"),r.a.createElement("input",{type:"text",value:this.props.curr_page,onChange:this.handleChange,className:"debug_text_input"})))}}]),t}(a.Component),q=n(58),H=n.n(q),V=n(59),$=n.n(V),Q=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).updatePage=function(e){n.props.updatePage(e)},n}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props.curr_page,n=this.props.max_per_page,a=Math.floor(n/2),c=Number(((this.props.total_data+1)/this.props.max_per_page+1).toFixed(0)),o=Array.from(new Array(n),function(e,r){return t<=a?r:t>=c-a?r+c-n:r+t-a-1}).map(function(n){return n+=1,r.a.createElement(M,{num:n,selected:t===n,key:n,updatePage:e.props.updatePage})});return r.a.createElement("div",null,r.a.createElement("div",{className:"table_header_footer"},r.a.createElement("div",{className:"table_footer"},r.a.createElement("div",{className:"left_footer"},r.a.createElement(W,{updatePage:this.props.updatePage,curr_page:this.props.curr_page})),r.a.createElement("div",{className:"right_footer"},r.a.createElement("img",{src:H.a,alt:"",className:"small_btn",onClick:function(){return e.props.updatePage(1)}}),r.a.createElement("img",{src:G.a,alt:"",className:"small_btn",onClick:function(){return e.props.updatePage(t-1)}}),o,r.a.createElement("img",{src:R.a,alt:"",className:"small_btn",onClick:function(){return e.props.updatePage(t+1)}}),r.a.createElement("img",{src:$.a,alt:"",className:"small_btn",onClick:function(){return e.props.updatePage(c)}})))))}}]),t}(a.Component),U=function(e){function t(e){return Object(d.a)(this,t),Object(m.a)(this,Object(p.a)(t).call(this,e))}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(L,null),r.a.createElement(D,{data:this.props.data,curr_page:this.props.curr_page,max_per_page:this.props.sentencesPerPageInTable,curr_sentence_index:this.props.curr_sentence_index}),r.a.createElement(Q,{total_data:this.props.data.length,updatePage:this.props.updatePage,curr_page:this.props.curr_page,max_per_page:this.props.sentencesPerPageInTable}))}}]),t}(a.Component),z=function(e){function t(){return Object(d.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"data_table"},r.a.createElement(U,{data:this.props.data,curr_sentence_index:this.props.curr_sentence_index,curr_page:this.props.curr_page,updatePage:this.props.updatePage,sentencesPerPageInTable:this.props.sentencesPerPageInTable})))}}]),t}(a.Component),J=n(20),K=n.n(J);function Y(e){var t=Object(J.useModali)({animated:!0,title:e.title,message:e.message,buttons:[r.a.createElement(K.a.Button,{label:e.buttonCancel?e.buttonCancel:"",isStyleCancel:!0,className:e.buttonCancel?"":"display_none",key:e.buttonCancel,hidden:!e.buttonCancel,onClick:function(){return o()}}),r.a.createElement(K.a.Button,{label:e.buttonConfirm,isStyleDestructive:!0,onClick:function(){e.confirmFunc&&e.confirmFunc(),o(),e.toast&&_.a.info(e.toast,{onClick:function(e){e()}})},hidden:!e.buttonConfirm,key:e.buttonConfirm})]}),n=Object(N.a)(t,2),c=n[0],o=n[1];return Object(a.useEffect)(function(){e.onLoadFunc&&e.onLoadFunc();try{e.buttonCancel||(document.getElementsByClassName("modali-button-cancel")[0].className+=" display_none"),e.buttonConfirm||(document.getElementsByClassName("modali-button-destructive")[0].className+=" display_none")}catch(t){}},[]),r.a.createElement("div",{style:{height:"0px"}},r.a.createElement("button",{className:"hidden_button",id:e.modalID,onClick:o},"toggle modal"),r.a.createElement(K.a.Modal,c))}function X(e){var t=Object(a.useState)(1/0),n=Object(N.a)(t,2),c=n[0],o=n[1],s=void 0;Object(a.useEffect)(function(){clearInterval(s),e.socket.on("server: response for start time",function(e){try{e=new Date(e);var t=u(e),n=u(new Date)-t,a=Math.floor(n/3600);n-=3600*a;var r=Math.floor(n/60),c=[a,r,n-=60*r];i(c),s=setInterval(function(){return d(c)},1e3)}catch(o){console.error(o)}}),m(),o(0),console.log(c)},[]);var i=function(e){try{document.getElementById("total_time_elapsed").style.color="rgba(255,255,255,0.8",document.getElementById("total_time_elapsed").innerText="\u603b\u8bb0\u5f55\u65f6\u95f4: "+("0"+e[0]).slice(-2)+":"+("0"+e[1]).slice(-2)+":"+("0"+e[2]).slice(-2)}catch(t){}},l=void 0,d=function(e){l||(l=e);var t=l[0],n=l[1],a=l[2];a<60&&(a+=1),60===a&&(n+=1,a=0),60===n&&(t+=1,n=0),l=[t,n,a];try{i(l)}catch(r){console.error(r)}},u=function(e){return 60*e.getHours()*60+60*e.getMinutes()+e.getSeconds()},m=function(){try{document.getElementById("showTimeBtn").click(),document.getElementById("showTimeBtn").disabled=!0}catch(e){}};return r.a.createElement("div",null,r.a.createElement("pre",{id:"total_time_elapsed",style:{color:"rgba(255,255,255,0.8"}},"\u603b\u8bb0\u5f55\u65f6\u95f4: 00:00:00"),r.a.createElement("button",{onClick:function(){e.socket.emit("client: ask for start time")},id:"showTimeBtn",className:"hidden_button"}))}n(131);function Z(e){return Object(a.useEffect)(function(){var t=document.getElementById(e.id);try{t.addEventListener("change",function(){e.onChangeFunc(t.checked)})}catch(n){}},[]),r.a.createElement("div",{className:"switch-wrapper"},r.a.createElement("div",{className:"switch"},r.a.createElement("div",{className:"invisible_pushdown"}),r.a.createElement("input",{type:"checkbox",name:"toggle",id:e.id,checked:e.checked,onChange:e.updateDebugMode}),r.a.createElement("label",{htmlFor:"toggle",className:"inset-toggle"},r.a.createElement("i",null))))}n(132);function ee(){return r.a.createElement("div",{className:"checkmark-container"},r.a.createElement("div",{className:"checkmark"},r.a.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 161.2 161.2",enableBackground:"new 0 0 161.2 161.2",xmlSpace:"preserve"},r.a.createElement("path",{className:"path",fill:"none",stroke:"#FFBA49",strokeMiterlimit:"10",d:"M425.9,52.1L425.9,52.1c-2.2-2.6-6-2.6-8.3-0.1l-42.7,46.2l-14.3-16.4\r c-2.3-2.7-6.2-2.7-8.6-0.1c-1.9,2.1-2,5.6-0.1,7.7l17.6,20.3c0.2,0.3,0.4,0.6,0.6,0.9c1.8,2,4.4,2.5,6.6,1.4c0.7-0.3,1.4-0.8,2-1.5\r c0.3-0.3,0.5-0.6,0.7-0.9l46.3-50.1C427.7,57.5,427.7,54.2,425.9,52.1z"}),r.a.createElement("circle",{className:"path",fill:"none",stroke:"#FFBA49",strokeWidth:"4",strokeMiterlimit:"10",cx:"80.6",cy:"80.6",r:"62.1"}),r.a.createElement("polyline",{className:"path",fill:"none",stroke:"#FFBA49",strokeWidth:"6",strokeLinecap:"round",strokeMiterlimit:"10",points:"113,52.8 \r 74.1,108.4 48.2,86.4 "}),r.a.createElement("circle",{className:"spin",fill:"none",stroke:"#FFBA49",strokeWidth:"4",strokeMiterlimit:"10",strokeDasharray:"12.2175,12.2175",cx:"80.6",cy:"80.6",r:"73.9"}))),r.a.createElement("p",{id:"complete_message"},"\ud83d\udd25 \u606d\u559c\u60a8\u5b8c\u6210 \ud83d\udd25"))}n(133);function te(){return r.a.createElement("div",{className:"pyro"},r.a.createElement("div",{className:"before"}),r.a.createElement("div",{className:"after"}))}n(134);function ne(){return r.a.createElement("div",{className:"CompleteAnimationBG"},r.a.createElement(te,null),r.a.createElement(ee,null))}var ae=n(38);function re(e){var t=(e.curr/(e.total+1)*100).toFixed(2),n="left"===e.align?{margin:"0"}:{};return r.a.createElement("div",{className:"progress_bar",style:n},r.a.createElement("pre",{style:{color:e.strokeColor}},e.title,": ",e.curr," / ",e.total+1," (",t,"%)"),r.a.createElement("div",{style:{height:"7px"}}),"line"===e.shape&&r.a.createElement(ae.b,{className:"line-progress",percent:t,strokeWidth:e.strokeWidth,trailWidth:e.strokeWidth,strokeColor:e.strokeColor,trailColor:"#363732"}),"circle"===e.shape&&r.a.createElement(ae.a,{className:"circle-progress",percent:t,strokeWidth:e.strokeWidth,trailWidth:e.strokeWidth,strokeColor:e.strokeColor,trailColor:"#363732"}))}var ce=n(60),oe=n.n(ce),se=n(61),ie=n.n(se),le=n(62),de=n.n(le),ue=n(63),me=n.n(ue),pe=n(64),ge=n.n(pe),he=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(m.a)(this,Object(p.a)(t).call(this,e))).sentencesPerPageInTable=4,n.curr_index=b("sentence_index"),n.ip_address="http://192.168.0.103:5000",n.showNoCamsRef=void 0,n.hideServerOfflineRef=void 0,n.Desktop=function(e){var t=e.children;return Object(S.useMediaQuery)({minWidth:992})?t:null},n.Tablet=function(e){var t=e.children;return Object(S.useMediaQuery)({minWidth:768,maxWidth:991})?t:null},n.Mobile=function(e){var t=e.children;return Object(S.useMediaQuery)({maxWidth:767})?t:null},n.Default=function(e){var t=e.children;return Object(S.useMediaQuery)({minWidth:768})?t:null},n.terminal=function(){},n.handler_hoverMouseOutDebug=function(){try{document.getElementsByClassName("debug-group")[0].className+=" hideDebug"}catch(e){console.error(e)}},n.handler_hoverMouseOverDebug=function(){try{document.getElementsByClassName("debug-group")[0].classList.remove("hideDebug")}catch(e){console.error(e)}},n.handler_hoverMouseOutBottom=function(){try{document.getElementsByClassName("panel_BG")[0].className+=" hideBottom"}catch(e){console.error(e)}},n.handler_hoverMouseOverBottom=function(){try{document.getElementsByClassName("panel_BG")[0].classList.remove("hideBottom")}catch(e){console.error(e)}},n.comp_saveProgress=function(e){return(b("name")||e)&&1!==n.state.requiredNumCams?r.a.createElement(re,{title:"\u89c6\u9891\u6587\u4ef6\u5df2\u4fdd\u5b58",curr:n.state.numFilesSavedInd,total:n.state.requiredNumCams-1,align:"center",strokeWidth:17,shape:"circle",strokeColor:"lightgreen"}):r.a.createElement(r.a.Fragment,null)},n.main_userView=function(){return r.a.createElement("div",{className:"container"},n.comp_debug(),n.comp_tester(),n.comp_bottomAdmin(!0))},n.comp_totalProgress=function(e,t){return b("name")||e?r.a.createElement(re,{shape:"line",title:"\u8bfb\u5b8c\u53e5\u5b50\u7684\u8fdb\u5ea6",curr:n.state.recordProgress,total:n.state.data.length-1,align:"center",strokeWidth:t,strokeColor:"#3bb8ce"}):r.a.createElement(r.a.Fragment,null)},n.comp_bottomAdmin=function(e){return r.a.createElement("div",{className:"contents"},r.a.createElement("div",{className:"panel_BG hideBottom"},r.a.createElement("div",{style:{marginTop:"-50px"}},r.a.createElement("div",{style:{width:"100vw",height:"50px",position:"relative",top:"50px",left:"0"},onClick:n.helper_toggleHideBottom}," "),r.a.createElement("img",{style:{position:"relative",top:"0",left:"0"},className:"chevron",src:ge.a})),r.a.createElement("div",{className:"panel_container"},r.a.createElement("div",{className:"left_panel"},n.comp_dataCollection()),e&&r.a.createElement("div",{className:"right_panel"},r.a.createElement("h3",null,"Cameras"),r.a.createElement("div",{className:"cameras_container"},n.comp_cameraList())))))},n.main_adminView=function(){return r.a.createElement("div",{style:{textAlign:"center"}},n.comp_debug())},n.main_playground=function(){return r.a.createElement(Z,null)},n.comp_debugHover=function(){},n.comp_completeAnimation=function(){if(n.state.recordProgress+1===n.state.data.length){try{document.getElementById("testerNextBtn").disabled=!0}catch(e){}return r.a.createElement(ne,null)}},n.comp_dataCollection=function(){return r.a.createElement(z,{data:n.state.data,updateName:n.updateName,curr_sentence:n.state.currSentence,socket:n.state.socket,curr_sentence_index:n.state.currSentenceIndex,curr_page:n.state.currPageInTable,updatePage:n.updatePage,sentencesPerPageInTable:n.state.sentencesPerPageInTable})},n.comp_tester=function(){return r.a.createElement(j,{updateSentence:n.updateSentence,data:n.state.data,curr_sentence_index:n.state.currSentenceIndex,data_length:n.state.data.length,first_sentence:n.state.data[n.state.currSentenceIndex],curr_sentence:n.state.currSentence,socket:n.state.socket,recordGreenLight:n.state.recordGreenLight&&n.state.numFilesSavedTotal%n.state.requiredNumCams===0,debugMode:n.state.debugMode,numFilesSaved:n.state.numFilesSavedTotal,requiredNumCams:n.state.requiredNumCams,updateGreenLightStatus:n.updateGreenLightStatus,recordedProgress:n.state.recordProgress,updateRecordProgress:n.updateRecordProgress,totalTime:n.state.totalTime,updateTotalTime:n.updateTotalTime,showFileSavingLoader:n.disp_showFileSavingLoader,connectedToServer:n.state.connectedToServer,detectedNumCams:n.state.detectedNumCams,comp_saveProgress:n.comp_saveProgress,comp_totalProgress:n.comp_totalProgress})},n.comp_cameraList=function(){return r.a.createElement(O,{socket:n.state.socket,computerID:n.state.computerID,computerStatus:n.state.computerStatus,updateConnectionStatus:n.updateConnectionStatus,addCamState:n.state.addCamState,toggleCamState:n.helper_toggleCamState,updateDetectedNumCams:n.updateDetectedNumCams,addCam:n.admin_resetCams})},n.comp_status=function(){return r.a.createElement(X,{totalWords:n.state.totalWords,data_length:n.state.data.length,recordedProgress:n.state.recordProgress,helper_checkIfMobileView:n.helper_checkIfMobileView,recordGreenLight:n.state.recordGreenLight,socket:n.state.socket})},n.comp_modals=function(){return r.a.createElement("div",null,r.a.createElement(Y,{modalID:"resetProgressModal",socket:n.state.socket,title:"Are you sure?",message:"Resetting progress will be permanent.",buttonCancel:"Cancel",buttonConfirm:"Reset Progress",buttonConfirmId:"resetProgressBtn",toast:"Progress reset",confirmFunc:n.admin_resetProgress}),r.a.createElement(Y,{modalID:"overallStatus",socket:n.state.socket,title:"Status",onLoadFunc:n.getStatus,message:n.comp_status(),buttonConfirm:"Hide"}))},n.updateDebugMode=function(){n.setState({debugMode:!n.state.debugMode})},n.comp_debug=function(){return r.a.createElement("div",{className:"debug-group hideDebug"},r.a.createElement("label",{className:"debug_label"},"Admin: "),r.a.createElement("button",{id:"resetCamsBtn",className:"debug_button",onClick:n.admin_resetCams},"Add Webcam"),r.a.createElement("button",{className:"debug_button",onClick:function(){n.helper_toggleModal("resetProgressModal")}},"Reset Progress"),r.a.createElement("div",{className:"debug_inline_group"},r.a.createElement("label",{className:"debug_label"},"Debug: "),r.a.createElement(Z,{id:"debug_mode",onChangeFunc:n.handler_debugToggle,checked:n.state.debugMode,updateDebugMode:n.updateDebugMode})),r.a.createElement("div",{className:"debug_inline_group"},r.a.createElement("label",{htmlFor:"",className:"debug_label"},"Cams:"," "),r.a.createElement("input",{id:"numCamsInput",type:"text",className:"debug_text_input debug_sm_input warning_message",value:n.state.detectedNumCams,readOnly:!0})),r.a.createElement("div",{className:"debug_inline_group"},r.a.createElement("label",{htmlFor:"",className:"debug_label"},"Server:"," "),r.a.createElement("span",{className:"server_status"}),r.a.createElement("input",{id:"inputServerIP",type:"text",className:"debug_text_input warning_message",value:n.state.ip,onChange:n.handler_IPOnChange}),r.a.createElement("button",{className:"debug_button",onClick:n.handler_useThisCompAsServer}," ","\ud83d\udce1"," ")),r.a.createElement("div",{style:{width:"100%",height:"100%"},onClick:n.helper_toggleHideDebug},r.a.createElement("img",{className:"chevron top-chevron",src:me.a}),r.a.createElement("div",{style:{height:"0.3em"}})),r.a.createElement("button",{onClick:n.disp_showFileSavedMessage,id:"showSavedFilesBtn",className:"hidden_button"}))},n.updateFilesSaved=function(e){var t=e%n.state.requiredNumCams===0?" (successful)":" (not all saved)";n.setState({numFilesSavedTotal:e})," (successful)"===t&&n.updateGreenLightStatus(!0);try{document.getElementById("num_files_saved").innerHTML="Total Files Saved: "+e+t}catch(a){}},n.handler_useThisCompAsServer=function(){de.a.clientGetIP(function(e){console.log(e),4===e.split(".").length&&(e="http://"+e+":5000",_.a.loading(e,{position:"top-right",hideAfter:3,onClick:function(e){e()}}),n.helper_setServerIP(e))})},n.handler_IPOnChange=function(e){n.setState({ip:e.target.value})},n.debugCogoToastOnRef=void 0,n.debugCogoToastOffRef=void 0,n.showDebugOn=function(){return _.a.success(r.a.createElement("p",null,"Debug on. ",r.a.createElement("br",null),"Required Cams: 1"),{hideAfter:1,onClick:function(e){return e()}})},n.showDebugOff=function(){return _.a.warn(r.a.createElement("p",null,"Debug off. ",r.a.createElement("br",null),"Required Cams: 8"),{hideAfter:1,onClick:function(e){return e()}})},n.handler_debugToggle=function(e){console.log("toggling debug mode"),n.setState({debugMode:e},function(){e?(n.setState({requiredNumCams:1}),n.debugCogoToastOnRef=n.showDebugOn()):(n.setState({requiredNumCams:8}),n.debugCogoToastOffRef=n.showDebugOff(),n.handler_hoverMouseOutBottom())})},n.handler_fileSaveSuccess=function(e){n.updateFilesSaved(e),n.setState({numFilesSavedInd:n.state.numFilesSavedInd+1},function(){if(n.state.numFilesSavedInd===n.state.requiredNumCams)try{document.getElementById("showSavedFilesBtn").click(),document.getElementById("showSavedFilesBtn").disabled=!0,n.setState({numFilesSavedInd:0},function(){_.a.success(n.style_makeEmojiToastLayout(["\u89c6\u9891\u5df2\u6210\u529f\u4fdd\u5b58","\u53ef\u7ee7\u7eed\u5f55"],"\ud83d\udd25"),{hideAfter:1,onClick:function(e){e()}})}),n.updateGreenLightStatus(!0)}catch(e){console.error(e)}try{document.getElementById("testerNextBtn").disabled=!0}catch(t){}})},n.updateDetectedNumCams=function(e){n.setState({detectedNumCams:e}),n.state.socket.emit("client: updateTotalCams",function(){return[n.state.computerID,e]}),n.updateGreenLightStatus(!0),n.showNoCamsRef&&n.showNoCamsRef();try{document.getElementsByClassName("debug_sm_input")[0].className+=n.state.detectedNumCams>0?" serverPlaceholderConnected":"",document.getElementById("numCamsInput").classList.remove("warning_message")}catch(t){}},n.updateCompID=function(e){var t={};n.setState({computerID:e}),t[n.state.computerID]=[],n.setState({computerStatus:t},function(){})},n.style_addThisCpuIcon=function(e,t){var n=new RegExp(t,"g");return e.replace(n,"\ud83d\udda5: "+t)},n.style_makeEmojiToastLayout=function(e,t){return r.a.createElement("div",{className:"cogo-toast"},r.a.createElement("div",{className:"cogo-toast-emoji-left"}," ",t),r.a.createElement("div",null,e[0],r.a.createElement("br",null),e[1]),r.a.createElement("div",{className:"cogo-toast-emoji-right"}," ",t))},n.ref_hideLoader=void 0,n.disp_showFileSavingLoader=function(){n.ref_hideLoader=_.a.loading(n.style_makeEmojiToastLayout(["\u89c6\u9891\u6b63\u5728\u4fdd\u5b58","\u8bf7\u8010\u5fc3\u7b49\u5f85"],"\u231b\ufe0f"),{hideAfter:0,onClick:function(e){e()}})},n.disp_showFileSavedMessage=function(){try{n.ref_hideLoader()}catch(e){}},n.disp_showServerConencted=function(){_.a.success("Server is online.",{position:"top-right",hideAfter:0,onClick:function(e){e()}}),n.hideServerOfflineRef&&n.hideServerOfflineRef();try{document.getElementsByClassName("server_status")[0].classList.add("server_online"),document.getElementById("inputServerIP").classList.add("serverPlaceholderConnected"),document.getElementById("inputServerIP").classList.remove("warning_message")}catch(e){}},n.initSocketListeners=function(){n.state.socket.on("server: online",function(){n.disp_showServerConencted()}),n.state.socket.on("server: sync name, sentence index",function(e){var t=e.name,a=e.currSentenceIndex;n.setState({name:t,currSentenceIndex:a})}),n.hideServerOfflineRef?n.hideServerOfflineRef():n.hideServerOfflineRef=n.helper_showServerNotOnline(),n.state.socket.on("server: disconnected",function(){n.setState({connectedToServer:!1},function(){document.getElementsByClassName("server_status")[0].classList.remove("server_online"),document.getElementById("inputServerIP").classList.remove("serverPlaceholderConnected")})}),n.state.socket.on("server: connected",function(e){n.disp_showServerConencted(),n.setState({connectedToServer:!0,computerID:e},function(){try{document.getElementById("inputServerIP").classList.add("serverPlaceholderConnected")}catch(e){}})}),n.state.socket.on("server: connected sync id",function(e){n.updateCompID&&n.updateCompID(e),n.updateCompID=null}),n.state.socket.on("server: reset cams",function(){n.updateGreenLightStatus(!0)}),n.state.socket.on("server: response for connection status",function(e){try{document.getElementById("connection_status").innerHTML=n.style_addThisCpuIcon(JSON.stringify(e,null,2),n.state.computerID)}catch(t){}}),n.state.socket.on("server: response for progress",function(e){n.setState({recordProgress:e||0})}),n.state.socket.on("server: response for numFilesSaved",function(e){n.updateFilesSaved(e)}),n.state.socket.on("server: save files successful",function(e){n.handler_fileSaveSuccess(e)}),n.state.socket.on("server: computer connected order",function(e){n.setState({connectedOrderMap:v()(n.state.connectedOrderMap,{$merge:e})})});var e=[0,666,1332];n.state.socket.on("server: refresh all",function(){var t=n.state.connectedOrderMap[n.state.computerID];setTimeout(function(){window.location.reload(!1)},e[t%3])})},n.updateSentence=function(e){"$next"===e?n.setState({currSentenceIndex:n.state.currSentenceIndex+1},function(){n.updateSentence(n.state.data[n.state.currSentenceIndex]),n.state.socket.emit("client: update sentence_index",{name:b("name"),currSentenceIndex:n.state.currSentenceIndex})}):"$prev"===e?n.setState({currSentenceIndex:Math.max(n.state.currSentenceIndex-1,0)},function(){n.updateSentence(n.state.data[n.state.currSentenceIndex]),n.state.socket.emit("client: update sentence_index",{name:b("name"),currSentenceIndex:n.state.currSentenceIndex})}):(window.history.pushState(null,null,"?name="+b("name")+"&sentence_index="+n.state.currSentenceIndex),n.setState({currSentence:e,currPageInTable:Math.floor(Number(n.state.currSentenceIndex)/n.state.sentencesPerPageInTable)+1}))},n.updatePage=function(e){console.log("update page",e),n.setState({currPageInTable:e>=1?e:1})},n.updateRecordProgress=function(e){n.setState({recordProgress:e},function(){n.state.socket.emit("client: update recording progress",e)})},n.updateConnectionStatus=function(e){if(n.state.computerStatus[n.state.computerID]){var t={};t[n.state.computerID]=e,n.setState({computerStatus:t},function(){}),n.state.socket.emit("client: update recording status",t)}n.getStatus()},n.updateGreenLightStatus=function(e){n.setState({recordGreenLight:e})},n.updateTotalTime=function(e){n.setState({totalTime:e})},n.getStatus=function(){n.state.socket.emit("client: ping for connection status"),n.state.socket.emit("client: ping for numFilesSaved"),n.state.socket.emit("client: ping for progress")},n.admin_resetCams=function(){n.state.socket.emit("client: reset cams");try{document.getElementById("addCamBtn").click()}catch(e){}n.state.socket.emit("client: dummy vid, do not save")},n.admin_refreshAll=function(){n.state.socket.emit("client: refresh all")},n.admin_resetProgress=function(){n.state.socket.emit("client: update recording progress",0),n.state.socket.emit("client: delete total time"),n.state.socket.emit("client: reset total files"),n.state.socket.emit("client: save total start time",new Date),window.location=window.location.origin+window.location.pathname,n.state.socket.emit("client: save total time",[0,0,0])},n.helper_emitInitialSocketMessages=function(){n.helper_checkIfMobileView?n.state.socket.emit("client: ask for recording status"):n.state.socket.emit("client: update sentence_index",{name:b("name"),currSentenceIndex:n.state.currSentenceIndex}),n.state.socket.emit("client: check for progress"),n.state.socket.emit("client: ask for sync id")},n.helper_toggleModal=function(e){document.getElementById(e).click()},n.helper_checkIfMobileView=function(){return window.location.href.includes("mobile")},n.helper_showNoCamsConnected=function(){return _.a.warn("No Webcams",{hideAfter:0,position:"top-left",onClick:n.admin_resetCams})},n.helper_showServerNotOnline=function(){return _.a.warn("Server is offline",{hideAfter:0,position:"top-right",onClick:function(e){n.handler_useThisCompAsServer(),e()}})},n.helper_setServerIP=function(e){n.state.socket.disconnect();try{document.getElementsByClassName("server_status")[0].classList.remove("server_online"),document.getElementById("inputServerIP").classList.remove("serverPlaceholderConnected")}catch(t){}n.setState({socket:C()(e),ip:e}),n.state.socket.emit("client: check server connection"),setTimeout(function(){document.getElementsByClassName("server_status")[0].className.includes("server_online")||(n.hideServerOfflineRef=n.helper_showServerNotOnline())},3e3),n.initSocketListeners()},n.helper_addHoverEventListeners=function(){var e=document.getElementById("debug_hover_area"),t=document.getElementById("bottom_hover_area");e.addEventListener("mouseout",n.handler_hoverMouseOutDebug),e.addEventListener("mouseover",n.handler_hoverMouseOverDebug),t.addEventListener("mouseout",n.handler_hoverMouseOutBottom),t.addEventListener("mouseover",n.handler_hoverMouseOverBottom)},n.helper_removeHoverEventListeners=function(){var e=document.getElementById("debug_hover_area"),t=document.getElementById("bottom_hover_area");e.removeEventListener("mouseout",n.handler_hoverMouseOutDebug),e.removeEventListener("mouseover",n.handler_hoverMouseOverDebug),t.removeEventListener("mouseout",n.handler_hoverMouseOutBottom),t.removeEventListener("mouseover",n.handler_hoverMouseOverBottom),n.handler_hoverMouseOverBottom()},n.helper_toggleHideDebug=function(){try{document.getElementsByClassName("debug-group")[0].className.includes("hideDebug")?n.handler_hoverMouseOverDebug():n.handler_hoverMouseOutDebug()}catch(e){}},n.helper_toggleHideBottom=function(){console.log("toggling hide bottom");try{document.getElementsByClassName("panel_BG")[0].className.includes("hideBottom")?n.handler_hoverMouseOverBottom():n.handler_hoverMouseOutBottom()}catch(e){}},n.helper_toggleCamState=function(){n.setState({addCamState:!n.state.addCamState})},n.handler_keydown=function(e){var t=e.key,a=document.getElementById("inputServerIP");if([" ","ArrowLeft","ArrowRight","Escape","Enter","s"].includes(t))try{" "===t?(document.getElementById("testerRecordBtn").click(),e.preventDefault()):"ArrowLeft"===t?document.activeElement!==a&&(document.getElementById("testerPrevBtn").click(),e.preventDefault()):"ArrowRight"===t?document.activeElement!==a&&(document.getElementById("testerNextBtn").click(),e.preventDefault()):"Escape"===t?(document.getElementById("resetCamsBtn").click(),e.preventDefault()):"Enter"===t&&(console.log("detected enter key"),document.getElementsByClassName("modali-button-destructive")[0]&&(document.getElementsByClassName("modali-button-destructive")[0].click(),n.admin_resetProgress()),document.activeElement===a&&(n.helper_setServerIP(a.value),_.a.info("Updated IP: "+a.value,{onClick:function(e){e()}}),e.preventDefault()))}catch(r){}},n.state={addCamState:!1,connectedOrderMap:{},connectedToServer:!1,computerID:-1,computerStatus:{},currSentence:"",currSentenceIndex:n.curr_index?Number(n.curr_index):0,currPageInTable:n.curr_index?Math.floor(Number(n.curr_index)/n.sentencesPerPageInTable)+1:1,data:[],detectedNumCams:0,debugMode:!1,ip:n.ip_address,name:"",numFilesSavedTotal:0,numFilesSavedInd:0,recordProgress:0,recordGreenLight:!1,remainingWords:0,requiredNumCams:8,sentencesPerPageInTable:n.sentencesPerPageInTable,startTime:void 0,socket:C()(n.ip_address),totalTime:[],totalWords:0},n}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement(E.a,null,r.a.createElement(h.Helmet,null,r.a.createElement("title",null,"s3and0s\u2014webcam recorder")),r.a.createElement(y.a,{path:"/admin",exact:!0,component:this.main_adminView}),r.a.createElement("div",null,r.a.createElement(this.Desktop,null,this.main_userView()),r.a.createElement(this.Tablet,null,this.main_userView()),r.a.createElement(this.Mobile,null,this.main_adminView(),r.a.createElement("div",{className:"mobileAdminView",style:{textAlign:"center"}},r.a.createElement("p",{style:{fontSize:"0.8em"}},"\u53e5\u5b50\u7d22\u5f15: ",this.state.currSentenceIndex),this.state.pinyin?this.state.pinyin[this.state.currSentenceIndex]:"",r.a.createElement("br",null),this.state.data[this.state.currSentenceIndex],r.a.createElement(X,{socket:this.state.socket}),this.comp_totalProgress(!0,4),this.comp_saveProgress(!0),this.terminal()),this.comp_bottomAdmin()),r.a.createElement(this.Default,null,null)),this.comp_modals(),this.comp_completeAnimation())}},{key:"componentDidMount",value:function(){var e=this;try{this.helper_emitInitialSocketMessages(),this.readTextFile(oe.a,"data"),this.readTextFile(ie.a,"pinyin"),this.initSocketListeners(),document.getElementById("debug_mode").checked=1===this.state.requiredNumCams,window.addEventListener("keydown",this.handler_keydown),window.addEventListener("keyup",this.handler_keyup),Object(S.useMediaQuery)({minWidth:768})&&(this.showNoCamsRef=this.helper_showNoCamsConnected()),setTimeout(function(){document.getElementsByClassName("server_status")[0].className.includes("server_online")||(e.hideServerOfflineRef=e.helper_showServerNotOnline())},1e3)}catch(t){}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handler_keydown)}},{key:"readTextFile",value:function(e,t){var n=this;fetch(e).then(function(e){return e.text()}).then(function(e){"data"===t?n.setState({data:e.split("\n")},function(){var e=b("sentence_index")?n.state.data[Number(b("sentence_index"))]:n.state.data[0];n.setState({currSentence:e},function(){}),n.setState({totalWords:n.state.data.reduce(function(e,t){return e+t.length},0)})}):n.setState({pinyin:e.split("\n")})})}},{key:"pingServer",value:function(){var e=Object(l.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.state.socket.io.opts.hostname,e.next=4,fetch(t,{mode:"no-cors"});case 4:e.sent.ok?console.log("connection successful"):console.error("no response from server"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"handler_keyup",value:function(){var e=!0,t=!1,n=void 0;try{for(var a,r=document.getElementsByClassName("debug_button")[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){a.value.classList.remove("btn-active")}}catch(c){t=!0,n=c}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}}]),t}(r.a.Component);o.a.render(r.a.createElement(he,null),document.getElementById("root"))},56:function(e,t,n){e.exports=n.p+"static/media/collapse-chevron.f7659f72.svg"},57:function(e,t,n){e.exports=n.p+"static/media/expand-chevron.bab69e8c.svg"},58:function(e,t,n){e.exports=n.p+"static/media/beg.26ab4fd7.svg"},59:function(e,t,n){e.exports=n.p+"static/media/end.782b7486.svg"},60:function(e,t,n){e.exports=n.p+"static/media/sentences.6162e745.txt"},61:function(e,t,n){e.exports=n.p+"static/media/sentences-pinyin-accent-nospecialchar.4fd3afa3.txt"},62:function(e,t,n){var a=n(135).networkInterfaces();e.exports={nodeGetIP:function(){var e=void 0;return Object.keys(a).forEach(function(t){a[t].forEach(function(n){"IPv4"===n.family&&!1===n.internal&&"en0"===t&&(e=n.address)})}),console.log(e),e},clientGetIP:function(e){var t=new(window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection)({iceServers:[]}),n=function(){},a={},r=/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/g;function c(t){a[t]||e(t),a[t]=!0}t.createDataChannel(""),t.createOffer(function(e){e.sdp.split("\n").forEach(function(e){e.indexOf("candidate")<0||e.match(r).forEach(c)}),t.setLocalDescription(e,n,n)},n),t.onicecandidate=function(e){e&&e.candidate&&e.candidate.candidate&&e.candidate.candidate.match(r)&&e.candidate.candidate.match(r).forEach(c)}}}},63:function(e,t,n){e.exports=n.p+"static/media/up-chevron.2c8a940e.svg"},64:function(e,t,n){e.exports=n.p+"static/media/down-chevron.8bbb95c1.svg"},68:function(e,t,n){e.exports=n(138)},73:function(e,t,n){}},[[68,1,2]]]);
//# sourceMappingURL=main.b2f7e2a8.chunk.js.map